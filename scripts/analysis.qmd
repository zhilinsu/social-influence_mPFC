---
title: "Dorsomedial and ventromedial prefrontal cortex lesions differentially impact social influence and temporal impulsivity"
author: "Zhilin Su"
date: "2025"
date-format: "YYYY"
format: html
page-layout: full 
toc: true
toc-depth: 6
embed-resources: true 
theme: default
mainfont: Roboto 
fontsize: 12pt 
---

# Preparation 

```{r}
#| label: setting 
#| echo: false 
#| warning: false 

# Clear up 
rm(list = ls())

# Whether to re-save results? 0 for no; 1 for yes. 
is_save <- 0
```

```{r}
#| label: libraries  
#| echo: false 
#| warning: false 

# Load libraries ---- 
## Data wrangling 
library(dplyr)
library(readr)
library(forcats)
library(stringr)

## Visualisation 
library(ggplot2)
library(ggpubr)
library(ggtext) # to format the annotations on plots 
library(ggpattern)
library(ggsignif)
library(grid) # to control the grid parameters 
library(gridExtra)
library(patchwork)

## Statistics & modelling 
library(rstatix)
library(lme4)
library(lmerTest)
library(Hmisc) # rcorr
library(sjPlot)
library(parameters)
library(performance)
library(arm)
library(BayesFactor) 
library(emmeans)
library(effectsize) 
library(statpsych)

## Others 
library(finalfit) # p_tidy() 
library(kableExtra) 
library(mixedpower) # power analysis 
source("scripts/helper_functions/helper_functions.R")
source("scripts/helper_functions/rankBasedCommonFunctions.R")
source("scripts/helper_functions/spearmanSampler.R")
```

```{r}
#| label: plot_setting 
#| echo: false 
#| warning: false 

resolution <- 1200
plot_h <- 4
ax_text <- 12
ax_title <- 16
```

# Exclusion 

```{r}
#| label: exclusion 
#| echo: false 
#| warning: false 

excl_id <- c(110, 111, 118, 158, 220, 261, 273)
excl_id_qnr <- c(106, 266)
```

```{r}
#| label: inclusion 
#| echo: false 
#| warning: false 

demogr <- read_csv("data/demographics.csv") |> 
	rename(id = ID_Code, group = `Group SD mPFC`, age = Age, gender = Gender) |> 
	dplyr::select(id, group, age, gender) |> 
	mutate(id = if_else(id == 2012, 299, id))

qnr <- read_csv("data/questionnaires.csv") |>  
		rename(id = ID_Code, 
				 iq = WTAW_Standard, 
				 trail_a = `Trail_Making_A_(seconds)'`, 
				 trail_b = `Trail_Making_B_(seconds)'`, 
				 ami_total = AMI_tot, 
				 ami_ba = AMI_BA, 
				 ami_sm = AMI_SM, 
				 ami_es = AMI_ES, 
				 bdi_total = BDI_total, 
				 edu = Education_years) |>  
	dplyr::select(id, iq, trail_a, trail_b, ami_total, ami_ba, ami_sm, ami_es, bdi_total, edu, 
								SD_similar_p1, SD_similar_p2) |>   
	mutate(id = if_else(id == 2012, 299, id))

inclusion_data <- demogr %>%
	left_join(qnr, by = "id") %>% 
	filter(!id %in% excl_id)

inclusion_data <- inclusion_data %>% 
	filter(group == 3 | group == 4 | (group == 1 & age >= 24 & age <= 76)) %>% 
	filter(group == 3 | group == 4 | (group == 1 & trail_b > 40))

# IDs that are included 
incl_id_hc <- inclusion_data %>%
	filter(group == 1) %>%
	pull(id)

incl_id_mpfc <- inclusion_data %>%
	filter(group == 3) %>%
	pull(id)

incl_id_lc <- inclusion_data %>%
	filter(group == 4) %>%
	pull(id)

if (is_save == 1) {
	saveRDS(incl_id_hc, file = "data/incl_id_hc.RDS")
	saveRDS(incl_id_mpfc, file = "data/incl_id_mpfc.RDS")
	saveRDS(incl_id_lc, file = "data/incl_id_lc.RDS")
}
```